<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Aidan's Blog</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="style.css">
    </head>

    <body onload="fileList();">


        <h1 id="siteID">Posts</h1>
        <div id="feed">
            <p>List of blog posts should appear here pleaseeee...</p>
        </div>
        <br>
    
    </body>

    <footer>
        <hr>
        <small> <p>&copy; Aidan Carr December 28, 2023</p> </small>
    </footer>


    <script>
                
        function fileList(){
            htmlString = "";

            (async () => {

                //get data from json file
                //must read from website (annoying)
                const response = await fetch("https://aidancarr1.github.io/Blog/data.json");
                const data = await response.json();
                
                let posts = Object.keys(data['posts']);
                let images = Object.keys(data['images']);

                //go through every post
                for(const i in posts){
                    
                    //json post data
                    thisPost = posts[i];
                    thisDate = data["posts"][thisPost].date;
                    thisTitle = data["posts"][thisPost].title;
                    thisContent = data["posts"][thisPost].content;
                    
                    //create div
                    //htmlString += "<div class='postBox' onclick='openPage("+'"'+thisPost+'"'+")'>";
                    htmlString += "<div class='postBox'>";
                    
                    //title and date
                    htmlString += "<h2 class='title'>" + thisTitle + "</h2>";
                    htmlString += "<h3 class='date'>" + thisDate +"</h3>";
                    
                    //content
                    htmlString += "<div class='content'><p>" + thisContent + "</p></div>";
                    
                    //check all images
                    for(const j in images){

                        thisImage = images[j];
                        thisImagePostID = data["images"][thisImage].postID;

                        //if this image is related to this post...
                        if (thisImagePostID == thisPost){
                            thisImgURL = data["images"][thisImage].imgURL;
                            thisCaption = data["images"][thisImage].caption;

                            //display the image
                            htmlString += "<div class='imgBlob'> <img src= 'images/" + thisImgURL + "' alt= '" + thisCaption + "' width='500' >";

                            //write caption
                            htmlString += "<p class='caption'>" + thisCaption + "</p></div>";
                        
                            //create Modal
                            htmlString += "<div class='modal'>";
                            htmlString += "<span class='close'>&times;</span>";
                            htmlString += "<img class='modal-content'>";
                            htmlString += "<div id='caption'></div></div>";
                        }
                    }
                    htmlString += "</div>";
                }

                //put all posts into the feed
                document.getElementById('feed').innerHTML = htmlString;
            })()
            
        }
        
        function openPage(param) {
            var url = 'blogPost.html?postID=' + encodeURIComponent(param);
            window.open(url, '_self');
        }
        
        
        
        function goHome(){
            open("blogHome.html","_self");
        }
    </script>

</html>